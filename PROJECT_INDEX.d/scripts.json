{"module_id":"scripts","version":"2.0-split","modified":"2025-11-03T18:54:14.279304","files":{"scripts/impact.py":{"language":"python","functions":[{"name":"build_reverse_call_graph","line":24,"signature":"(call_graph: List[List[str]]) -> Dict[str, List[str]]","calls":["build_reverse_call_graph"],"doc":""},{"name":"analyze_impact","line":65,"signature":"(function_name: str, call_graph: List[List[str]], max_depth: int = 10) -> Dict[str, Any]","calls":["analyze_impact","build_reverse_call_graph"],"doc":""},{"name":"map_functions_to_paths","line":172,"signature":"(functions: List[str], index_data: Dict[str, Any]) -> Dict[str, Tuple[str, Optional[int]]]","calls":["map_functions_to_paths"],"doc":""},{"name":"format_impact_report","line":234,"signature":"(impact_result: Dict[str, Any], index_data: Optional[Dict[str, Any]] = None) -> str","calls":["analyze_impact","map_functions_to_paths"],"doc":""},{"name":"load_call_graph_from_index","line":301,"signature":"(index_path: Optional[Path] = None) -> List[List[str]]","calls":[],"doc":""}],"classes":[],"imports":["scripts.impact","collections","typing","json","pathlib","sys","pathlib","loader"]},"scripts/mcp_detector.py":{"language":"python","functions":[{"name":"detect_mcp_tools","line":24,"signature":"() -> Dict[str, bool]","calls":["_is_claude_code_environment","detect_mcp_tools"],"doc":""},{"name":"_is_claude_code_environment","line":104,"signature":"() -> bool","calls":[],"doc":""},{"name":"get_cached_capabilities","line":150,"signature":"() -> Optional[Dict[str, bool]]","calls":["detect_mcp_tools","get_cached_capabilities"],"doc":""},{"name":"reset_detection_cache","line":166,"signature":"() -> None","calls":["detect_mcp_tools","reset_detection_cache"],"doc":""}],"classes":[],"imports":["typing","sys","os"]},"scripts/test_hybrid_routing.py":{"language":"python","functions":[{"name":"run_all_tests","line":496,"signature":"()","calls":[],"doc":"Run all test suites and report results"}],"classes":[{"name":"TestQueryClassification","line":32,"bases":[],"methods":[{"name":"classify_query_type","line":35,"signature":"(self, query: str) -> str","calls":[],"doc":""},{"name":"test_explicit_file_ref_classification","line":65,"signature":"(self)","calls":["classify_query_type"],"doc":"Test classification of explicit file reference queries"},{"name":"test_semantic_search_classification","line":81,"signature":"(self)","calls":["classify_query_type"],"doc":"Test classification of semantic search queries"},{"name":"test_temporal_query_classification","line":97,"signature":"(self)","calls":["classify_query_type"],"doc":"Test classification of temporal queries"},{"name":"test_structural_query_classification","line":113,"signature":"(self)","calls":["classify_query_type"],"doc":"Test classification of structural/architectural queries"},{"name":"test_classification_priority","line":129,"signature":"(self)","calls":["classify_query_type"],"doc":"Test that classification prioritizes correctly when multiple signals present"}],"doc":"Test query type classification logic (AC: All)"},{"name":"TestRoutingStrategyA","line":144,"bases":[],"methods":[{"name":"create_mock_core_index","line":147,"signature":"(self) -> dict","calls":[],"doc":"Create a minimal core index for testing"},{"name":"test_strategy_a_uses_index_for_navigation","line":165,"signature":"(self)","calls":["create_mock_core_index"],"doc":"Verify Strategy A uses index for file navigation (AC2.6.1)"},{"name":"test_strategy_a_mcp_read_availability","line":182,"signature":"(self)","calls":[],"doc":"Verify Strategy A checks MCP Read availability (AC2.6.1)"},{"name":"test_strategy_a_routing_decision","line":191,"signature":"(self)","calls":[],"doc":"Test routing decision for explicit file ref with MCP Read (AC2.6.1)"}],"doc":"Test Strategy A: Explicit File Reference + MCP Read (AC2.6.1)"},{"name":"TestRoutingStrategyB","line":206,"bases":[],"methods":[{"name":"test_strategy_b_routing_decision","line":209,"signature":"(self)","calls":[],"doc":"Test routing decision for semantic search with MCP Grep (AC2.6.2)"},{"name":"test_strategy_b_mcp_grep_availability","line":223,"signature":"(self)","calls":[],"doc":"Verify Strategy B checks MCP Grep availability (AC2.6.2)"}],"doc":"Test Strategy B: Semantic Search + MCP Grep (AC2.6.2)"},{"name":"TestRoutingStrategyC","line":233,"bases":[],"methods":[{"name":"test_strategy_c_routing_decision","line":236,"signature":"(self)","calls":[],"doc":"Test routing decision for temporal query with MCP Git (AC2.6.3)"},{"name":"test_strategy_c_mcp_git_availability","line":250,"signature":"(self)","calls":[],"doc":"Verify Strategy C checks MCP Git availability (AC2.6.3)"}],"doc":"Test Strategy C: Temporal Query + MCP Git (AC2.6.3)"},{"name":"TestRoutingStrategyD","line":260,"bases":[],"methods":[{"name":"test_strategy_d_fallback_no_mcp","line":263,"signature":"(self)","calls":[],"doc":"Test fallback routing when MCP tools unavailable (AC2.6.4)"},{"name":"test_strategy_d_structural_queries","line":279,"signature":"(self)","calls":[],"doc":"Test that structural queries always use Strategy D (AC2.6.4)"}],"doc":"Test Strategy D: Fallback to Index-Only (AC2.6.4)"},{"name":"TestVerboseLogging","line":301,"bases":[],"methods":[{"name":"generate_verbose_log","line":305,"signature":"(self, query: str, query_type: str, mcp_capabilities: dict, selected_strategy: str) -> str","calls":[],"doc":"Generate verbose log output for routing decision"},{"name":"test_verbose_log_strategy_a","line":324,"signature":"(self)","calls":["generate_verbose_log"],"doc":"Test verbose logging for Strategy A (AC2.6.5)"},{"name":"test_verbose_log_strategy_d_fallback","line":341,"signature":"(self)","calls":["generate_verbose_log"],"doc":"Test verbose logging for Strategy D fallback (AC2.6.5)"}],"doc":"Test verbose logging of routing decisions (AC2.6.5)"},{"name":"TestRoutingIntegration","line":358,"bases":[],"methods":[{"name":"route_query","line":361,"signature":"(self, user_query: str, mcp_capabilities: dict) -> Tuple[str, str]","calls":[],"doc":""},{"name":"test_routing_all_strategies_with_mcp","line":397,"signature":"(self)","calls":["route_query"],"doc":"Test routing to all 4 strategies with full MCP availability"},{"name":"test_routing_all_fallback_no_mcp","line":414,"signature":"(self)","calls":["route_query"],"doc":"Test that all queries fallback to Strategy D without MCP"},{"name":"test_routing_with_mocked_mcp_detection","line":431,"signature":"(self)","calls":["route_query"],"doc":"Test routing with mocked MCP capabilities"}],"doc":"Integration tests for complete routing workflow (All ACs)"},{"name":"TestPerformance","line":444,"bases":[],"methods":[{"name":"route_query_timed","line":447,"signature":"(self, query: str, mcp_capabilities: dict) -> Tuple[str, str, float]","calls":[],"doc":"Route query and measure execution time"},{"name":"test_routing_performance_under_50ms","line":478,"signature":"(self)","calls":["route_query_timed"],"doc":"Verify routing completes in <50ms (performance requirement)"}],"doc":"Test performance requirements for hybrid routing"}],"imports":["json","os","sys","tempfile","time","unittest","pathlib","typing","unittest.mock","scripts.mcp_detector"]},"scripts/test_impact.py":{"language":"python","functions":[{"name":"run_all_tests","line":540,"signature":"()","calls":[],"doc":"Run all tests and print summary"}],"classes":[{"name":"TestBuildReverseCallGraph","line":33,"bases":[],"methods":[{"name":"test_simple_call_graph","line":36,"signature":"(self)","calls":[],"doc":"Should build reverse graph from forward edges"},{"name":"test_empty_call_graph","line":49,"signature":"(self)","calls":[],"doc":"Should return empty dict for empty call graph"},{"name":"test_malformed_edges","line":54,"signature":"(self)","calls":[],"doc":"Should skip malformed edges gracefully"},{"name":"test_no_duplicates","line":68,"signature":"(self)","calls":[],"doc":"Should not create duplicate callers"}],"doc":"Test reverse call graph construction"},{"name":"TestAnalyzeImpact","line":81,"bases":[],"methods":[{"name":"setUp","line":84,"signature":"(self)","calls":[],"doc":"Create sample call graph for testing"},{"name":"test_direct_callers_only","line":97,"signature":"(self)","calls":[],"doc":"Should identify direct callers (depth=1)"},{"name":"test_indirect_callers","line":105,"signature":"(self)","calls":[],"doc":"Should traverse multiple levels for indirect callers"},{"name":"test_max_depth_respected","line":113,"signature":"(self)","calls":[],"doc":"Should respect max_depth parameter"},{"name":"test_function_not_found","line":131,"signature":"(self)","calls":[],"doc":"Should return empty result for function not in graph"},{"name":"test_empty_call_graph","line":140,"signature":"(self)","calls":[],"doc":"Should handle empty call graph gracefully"}],"doc":"Test core impact analysis logic"},{"name":"TestCircularDependencies","line":148,"bases":[],"methods":[{"name":"test_simple_cycle","line":151,"signature":"(self)","calls":[],"doc":"Should detect simple cycle: A \u2192 B \u2192 A"},{"name":"test_complex_cycle","line":164,"signature":"(self)","calls":[],"doc":"Should handle complex cycle: A \u2192 B \u2192 C \u2192 A"},{"name":"test_self_loop","line":184,"signature":"(self)","calls":[],"doc":"Should handle self-referential function"}],"doc":"Test circular dependency detection and handling"},{"name":"TestFilePathMapping","line":198,"bases":[],"methods":[{"name":"setUp","line":201,"signature":"(self)","calls":[],"doc":"Create sample index data"},{"name":"test_map_with_line_numbers","line":214,"signature":"(self)","calls":[],"doc":"Should map functions to file paths with line numbers"},{"name":"test_map_without_line_numbers","line":222,"signature":"(self)","calls":[],"doc":"Should handle functions without line numbers"},{"name":"test_function_not_in_index","line":229,"signature":"(self)","calls":[],"doc":"Should mark unknown functions"},{"name":"test_empty_index","line":236,"signature":"(self)","calls":[],"doc":"Should handle empty index gracefully"}],"doc":"Test mapping functions to file paths and line numbers"},{"name":"TestFormatImpactReport","line":244,"bases":[],"methods":[{"name":"test_format_with_file_paths","line":247,"signature":"(self)","calls":[],"doc":"Should format report with file paths"},{"name":"test_format_without_file_paths","line":275,"signature":"(self)","calls":[],"doc":"Should format report without index data"},{"name":"test_format_empty_result","line":292,"signature":"(self)","calls":[],"doc":"Should format empty result with message"}],"doc":"Test impact report formatting"},{"name":"TestDualFormatSupport","line":309,"bases":[],"methods":[{"name":"setUp","line":312,"signature":"(self)","calls":["_cleanup"],"doc":"Create temporary test directories"},{"name":"_cleanup","line":317,"signature":"(self)","calls":[],"doc":"Clean up temp directory"},{"name":"test_load_from_split_architecture","line":323,"signature":"(self)","calls":[],"doc":"Should load and merge call graphs from split architecture"},{"name":"test_load_from_legacy_format","line":361,"signature":"(self)","calls":[],"doc":"Should load call graph from legacy single-file format"},{"name":"test_integration_with_split_index","line":380,"signature":"(self)","calls":[],"doc":"Integration test: Analyze impact using split architecture"},{"name":"test_integration_with_legacy_index","line":419,"signature":"(self)","calls":[],"doc":"Integration test: Analyze impact using legacy format"}],"doc":"Test integration with both split and legacy index formats"},{"name":"TestPerformance","line":448,"bases":[],"methods":[{"name":"test_large_call_graph_performance","line":451,"signature":"(self)","calls":[],"doc":"Should analyze 10,000 function graph in <500ms"},{"name":"test_deep_traversal_performance","line":479,"signature":"(self)","calls":[],"doc":"Should handle deep traversal efficiently"}],"doc":"Test performance requirements"},{"name":"TestEdgeCases","line":497,"bases":[],"methods":[{"name":"test_isolated_function","line":500,"signature":"(self)","calls":[],"doc":"Should handle function with no callers"},{"name":"test_multiple_paths_to_same_caller","line":513,"signature":"(self)","calls":[],"doc":"Should deduplicate callers reached via multiple paths"},{"name":"test_zero_max_depth","line":530,"signature":"(self)","calls":[],"doc":"Should handle max_depth=0 (no traversal)"}],"doc":"Test edge cases and error handling"}],"imports":["json","os","sys","tempfile","time","unittest","pathlib","typing","unittest.mock","scripts.impact","shutil"]},"scripts/test_mcp_detector.py":{"language":"python","functions":[{"name":"run_all_tests","line":369,"signature":"()","calls":[],"doc":"Run all test suites and return exit code."}],"classes":[{"name":"TestDetectMCPTools","line":28,"bases":[],"methods":[{"name":"setUp","line":31,"signature":"(self)","calls":[],"doc":"Reset detection cache before each test."},{"name":"tearDown","line":35,"signature":"(self)","calls":[],"doc":"Clean up after each test."},{"name":"test_all_tools_available","line":39,"signature":"(self)","calls":[],"doc":""},{"name":"test_partial_availability_read_grep_only","line":61,"signature":"(self)","calls":[],"doc":""},{"name":"test_no_tools_available","line":80,"signature":"(self)","calls":[],"doc":""},{"name":"test_detection_exception_handling","line":97,"signature":"(self)","calls":[],"doc":""},{"name":"test_caching_behavior","line":116,"signature":"(self)","calls":[],"doc":""},{"name":"test_get_cached_capabilities","line":135,"signature":"(self)","calls":[],"doc":""},{"name":"test_reset_detection_cache","line":155,"signature":"(self)","calls":[],"doc":""},{"name":"test_capability_map_immutability","line":180,"signature":"(self)","calls":[],"doc":""}],"doc":"Test suite for detect_mcp_tools() function."},{"name":"TestIsClaudeCodeEnvironment","line":202,"bases":[],"methods":[{"name":"test_claude_code_env_var","line":205,"signature":"(self)","calls":[],"doc":"Test detection via CLAUDE_CODE environment variable."},{"name":"test_claude_cli_env_var","line":211,"signature":"(self)","calls":[],"doc":"Test detection via CLAUDE_CLI environment variable."},{"name":"test_mcp_tools_available_marker","line":217,"signature":"(self)","calls":[],"doc":"Test detection via MCP_TOOLS_AVAILABLE marker."},{"name":"test_no_environment_markers","line":223,"signature":"(self)","calls":[],"doc":"Test detection returns False without environment markers."},{"name":"test_module_import_detection","line":229,"signature":"(self)","calls":[],"doc":"Test detection via MCP module availability."}],"doc":"Test suite for _is_claude_code_environment() internal function."},{"name":"TestPerformance","line":238,"bases":[],"methods":[{"name":"setUp","line":241,"signature":"(self)","calls":[],"doc":"Reset cache before performance tests."},{"name":"tearDown","line":245,"signature":"(self)","calls":[],"doc":"Clean up after performance tests."},{"name":"test_detection_under_100ms","line":249,"signature":"(self)","calls":[],"doc":""},{"name":"test_cached_retrieval_under_10ms","line":264,"signature":"(self)","calls":[],"doc":""}],"doc":"Performance validation tests for MCP detection."},{"name":"TestAgentIntegration","line":286,"bases":[],"methods":[{"name":"setUp","line":289,"signature":"(self)","calls":[],"doc":"Reset cache before integration tests."},{"name":"tearDown","line":293,"signature":"(self)","calls":[],"doc":"Clean up after integration tests."},{"name":"test_agent_initialization_pattern","line":297,"signature":"(self)","calls":[],"doc":""},{"name":"test_verbose_logging_pattern","line":320,"signature":"(self)","calls":[],"doc":""},{"name":"test_graceful_fallback_to_index_only","line":344,"signature":"(self)","calls":[],"doc":""}],"doc":"Integration tests simulating agent usage patterns."}],"imports":["json","os","sys","time","unittest","unittest.mock","pathlib","mcp_detector"]},"scripts/doc_classifier.py":{"language":"python","functions":[{"name":"classify_documentation","line":47,"signature":"(file_path: Path, config: Optional[Dict] = None) -> str","calls":["classify_documentation"],"doc":""}],"classes":[],"imports":["pathlib","typing"]},"scripts/find_python.sh":{"language":"shell","functions":[],"classes":[],"imports":[]},"scripts/git_metadata.py":{"language":"python","functions":[{"name":"extract_git_metadata","line":22,"signature":"(file_path: Path, root_path: Path, cache: Optional[Dict] = None) -> Dict","calls":["_extract_from_git","extract_git_metadata"],"doc":""},{"name":"_extract_from_git","line":77,"signature":"(file_path: Path, root_path: Path) -> Dict","calls":["_calculate_recency_days","_extract_lines_changed","_extract_pr_number","_fallback_to_mtime"],"doc":""},{"name":"_extract_pr_number","line":141,"signature":"(commit_message: str) -> Optional[str]","calls":["_extract_pr_number"],"doc":""},{"name":"_extract_lines_changed","line":177,"signature":"(file_path: Path, root_path: Path, commit_hash: str) -> Optional[int]","calls":[],"doc":""},{"name":"_calculate_recency_days","line":245,"signature":"(date_str: str) -> int","calls":[],"doc":""},{"name":"_fallback_to_mtime","line":276,"signature":"(file_path: Path) -> Dict","calls":["_calculate_recency_days"],"doc":""}],"classes":[],"imports":["re","subprocess","datetime","pathlib","typing"]},"scripts/i_flag_hook.py":{"language":"python","functions":[{"name":"find_project_root","line":23,"signature":"()","calls":[],"doc":"Find project root by looking for .git or common project markers."},{"name":"get_last_interactive_size","line":45,"signature":"()","calls":["find_project_root"],"doc":"Get the last remembered -i size from the index."},{"name":"parse_index_flag","line":66,"signature":"(prompt)","calls":["get_last_interactive_size"],"doc":"Parse -i or -ic flag with optional size."},{"name":"calculate_files_hash","line":104,"signature":"(project_root)","calls":[],"doc":"Calculate hash of non-ignored files to detect changes."},{"name":"should_regenerate_index","line":141,"signature":"(project_root, index_path, requested_size_k)","calls":["calculate_files_hash"],"doc":"Determine if index needs regeneration."},{"name":"generate_index_at_size","line":173,"signature":"(project_root, target_size_k, is_clipboard_mode=False)","calls":["calculate_files_hash"],"doc":"Generate index at specific token size."},{"name":"copy_to_clipboard","line":259,"signature":"(prompt, index_path)","calls":[],"doc":"Copy prompt, instructions, and index to clipboard for external AI."},{"name":"main","line":566,"signature":"()","calls":["copy_to_clipboard","find_project_root","generate_index_at_size","parse_index_flag","should_regenerate_index"],"doc":"Process UserPromptSubmit hook for -i and -ic flag detection."}],"classes":[],"imports":["json","sys","os","re","subprocess","hashlib","time","pathlib","datetime","sys","vm_client_network","vm_client","base64","pyperclip"]},"scripts/index_utils.py":{"language":"python","functions":[{"name":"extract_function_calls_python","line":74,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from Python code body."},{"name":"extract_function_calls_javascript","line":104,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from JavaScript/TypeScript code body."},{"name":"build_call_graph","line":132,"signature":"(functions: Dict, classes: Dict) -> Tuple[Dict, Dict]","calls":[],"doc":"Build bidirectional call graph from extracted functions and methods."},{"name":"extract_python_signatures","line":161,"signature":"(content: str) -> Dict[str, Dict]","calls":["extract_function_calls_python"],"doc":"Extract Python function and class signatures with full details for all files."},{"name":"extract_javascript_signatures","line":545,"signature":"(content: str) -> Dict[str, any]","calls":["extract_function_calls_javascript","pos_to_line"],"doc":"Extract JavaScript/TypeScript function and class signatures with full details."},{"name":"extract_function_calls_shell","line":906,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from shell script body."},{"name":"extract_shell_signatures","line":928,"signature":"(content: str) -> Dict[str, any]","calls":["extract_function_calls_shell"],"doc":"Extract shell script function signatures and structure."},{"name":"extract_markdown_structure","line":1186,"signature":"(file_path: Path) -> Dict[str, List[str]]","calls":[],"doc":"Extract headers and architectural hints from markdown files."},{"name":"infer_file_purpose","line":1217,"signature":"(file_path: Path) -> Optional[str]","calls":[],"doc":"Infer the purpose of a file from its name and location."},{"name":"infer_directory_purpose","line":1240,"signature":"(path: Path, files_within: List[str]) -> Optional[str]","calls":[],"doc":"Infer directory purpose from naming patterns and contents."},{"name":"extract_lightweight_signature","line":1270,"signature":"(func_data: Dict, func_name: str) -> str","calls":[],"doc":""},{"name":"get_language_name","line":1288,"signature":"(extension: str) -> str","calls":[],"doc":"Get readable language name from extension."},{"name":"parse_gitignore","line":1299,"signature":"(gitignore_path: Path) -> List[str]","calls":[],"doc":"Parse a .gitignore file and return list of patterns."},{"name":"load_gitignore_patterns","line":1319,"signature":"(root_path: Path) -> Set[str]","calls":["parse_gitignore"],"doc":"Load all gitignore patterns from project root and merge with defaults."},{"name":"matches_gitignore_pattern","line":1342,"signature":"(path: Path, patterns: Set[str], root_path: Path) -> bool","calls":[],"doc":"Check if a path matches any gitignore pattern."},{"name":"should_index_file","line":1386,"signature":"(path: Path, root_path: Path = None) -> bool","calls":["load_gitignore_patterns","matches_gitignore_pattern"],"doc":"Check if we should index this file."},{"name":"get_git_files","line":1406,"signature":"(root_path: Path) -> Optional[List[Path]]","calls":[],"doc":""}],"classes":[],"imports":["re","fnmatch","pathlib","typing","subprocess"]},"scripts/loader.py":{"language":"python","functions":[{"name":"load_detail_module","line":20,"signature":"(module_name: str, index_dir: Optional[Path] = None) -> Dict","calls":["load_detail_module"],"doc":""},{"name":"find_module_for_file","line":104,"signature":"(file_path: str, core_index: Dict) -> str","calls":["find_module_for_file"],"doc":""},{"name":"load_detail_by_path","line":199,"signature":"(file_path: str, core_index: Dict, index_dir: Optional[Path] = None) -> Dict","calls":["find_module_for_file","load_detail_by_path","load_detail_module"],"doc":""},{"name":"load_multiple_modules","line":236,"signature":"(module_names: List[str], index_dir: Optional[Path] = None) -> Dict[str, Dict]","calls":["load_detail_module","load_multiple_modules"],"doc":""},{"name":"load_doc_tier","line":306,"signature":"(tier: str, module_name: Optional[str] = None, index_dir: Optional[Path] = None) -> Dict[str, Dict]","calls":["load_detail_module","load_doc_tier"],"doc":""}],"classes":[],"imports":["pathlib","typing","json","logging","warnings"]},"scripts/project_index.py":{"language":"python","functions":[{"name":"detect_index_format","line":42,"signature":"(index_path: Path = None) -> str","calls":[],"doc":""},{"name":"load_configuration","line":80,"signature":"(config_path: Optional[Path] = None) -> Dict[str, any]","calls":[],"doc":""},{"name":"generate_tree_structure","line":142,"signature":"(root_path: Path, max_depth: int = MAX_TREE_DEPTH) -> List[str]","calls":["add_tree_level","should_include_dir"],"doc":"Generate a compact ASCII tree representation of the directory structure."},{"name":"generate_split_index","line":211,"signature":"(root_dir: str, config: Optional[Dict] = None) -> Tuple[Dict, int]","calls":["create_module_references","generate_detail_modules","generate_tree_structure","organize_into_modules"],"doc":""},{"name":"generate_detail_modules","line":525,"signature":"(files_data: Dict[str, Dict], modules: Dict[str, List[str]], root_path: Path, skip_details: bool = False, markdown_files_by_tier: Optional[Dict[str, List[Dict]]] = None) -> List[str]","calls":[],"doc":""},{"name":"build_index","line":714,"signature":"(root_dir: str, config: Optional[Dict] = None) -> Tuple[Dict, int]","calls":["generate_tree_structure"],"doc":"Build the enhanced index with architectural awareness (legacy single-file format)."},{"name":"convert_to_enhanced_dense_format","line":1023,"signature":"(index: Dict) -> Dict","calls":["truncate_doc"],"doc":"Convert to enhanced dense format that preserves all AI-relevant information."},{"name":"compress_if_needed","line":1148,"signature":"(dense_index: Dict, target_size: int = MAX_INDEX_SIZE) -> Dict","calls":[],"doc":"Compress dense index further if it exceeds size limit."},{"name":"organize_into_modules","line":1279,"signature":"(files: List[Path], root_path: Path, depth: int = 1) -> Dict[str, List[str]]","calls":[],"doc":""},{"name":"create_module_references","line":1317,"signature":"(modules: Dict[str, List[str]], functions: Dict[str, Dict]) -> Dict[str, Dict]","calls":[],"doc":""},{"name":"print_summary","line":1353,"signature":"(index: Dict, skipped_count: int)","calls":[],"doc":"Print a helpful summary of what was indexed."},{"name":"create_backup","line":1401,"signature":"(index_path: Path) -> Path","calls":[],"doc":""},{"name":"extract_legacy_data","line":1428,"signature":"(index_path: Path) -> Dict","calls":[],"doc":""},{"name":"validate_migration_integrity","line":1453,"signature":"(legacy_index: Dict, core_index: Dict, detail_modules: Dict[str, Dict]) -> bool","calls":[],"doc":""},{"name":"rollback_migration","line":1549,"signature":"(backup_path: Path, index_path: Path, detail_dir: Path)","calls":[],"doc":""},{"name":"migrate_to_split_format","line":1579,"signature":"(root_dir: str = '.', dry_run: bool = False) -> bool","calls":["create_backup","detect_index_format","extract_legacy_data","generate_split_index","load_configuration","rollback_migration","validate_migration_integrity"],"doc":""},{"name":"main","line":1795,"signature":"() -> None","calls":[],"doc":""}],"classes":[],"imports":["json","os","re","datetime","pathlib","typing","index_utils","doc_classifier","git_metadata","index_utils","index_utils","index_utils","index_utils","shutil","datetime","hashlib","shutil","shutil","datetime","argparse","sys","index_utils"]},"scripts/relevance.py":{"language":"python","functions":[{"name":"filter_files_by_recency","line":25,"signature":"(files: List[str], days: int, git_metadata: Dict[str, Any]) -> List[str]","calls":["filter_files_by_recency"],"doc":""}],"classes":[{"name":"RelevanceScorer","line":83,"bases":[],"methods":[{"name":"__init__","line":108,"signature":"(self, config: Optional[Dict[str, Any]] = None)","calls":[],"doc":""},{"name":"score_module","line":134,"signature":"(self, module: Dict[str, Any], query: Dict[str, Any], git_metadata: Dict[str, Any]) -> float","calls":["score_module"],"doc":""},{"name":"score_all_modules","line":207,"signature":"(self, modules: Dict[str, Dict[str, Any]], query: Dict[str, Any], git_metadata: Dict[str, Any]) -> List[tuple[str, float]]","calls":["score_all_modules","score_module"],"doc":""}],"doc":""}],"imports":["pathlib","typing","json"]},"scripts/stop_hook.py":{"language":"python","functions":[{"name":"main","line":14,"signature":"()","calls":[],"doc":"Stop hook - regenerate index if PROJECT_INDEX.json exists."}],"classes":[],"imports":["json","sys","os","subprocess","pathlib"]},"scripts/test_backward_compat.py":{"language":"python","functions":[],"classes":[{"name":"TestDetectIndexFormat","line":17,"bases":[],"methods":[{"name":"setUp","line":20,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":26,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_legacy_format_no_directory","line":31,"signature":"(self)","calls":[],"doc":"Test detection of legacy format when PROJECT_INDEX.d/ doesn't exist."},{"name":"test_split_format_with_directory_and_version","line":47,"signature":"(self)","calls":[],"doc":"Test detection of split format when both directory and version present."},{"name":"test_legacy_format_with_old_version","line":68,"signature":"(self)","calls":[],"doc":"Test legacy detection when version is 1.0."},{"name":"test_legacy_format_missing_version_field","line":86,"signature":"(self)","calls":[],"doc":"Test legacy detection when version field is missing."},{"name":"test_legacy_format_empty_index_file","line":103,"signature":"(self)","calls":[],"doc":"Test legacy detection with empty/corrupted index file."},{"name":"test_legacy_format_corrupted_json","line":112,"signature":"(self)","calls":[],"doc":"Test legacy detection with corrupted JSON."},{"name":"test_legacy_format_index_file_not_exists","line":120,"signature":"(self)","calls":[],"doc":"Test legacy detection when index file doesn't exist."},{"name":"test_split_format_empty_directory","line":126,"signature":"(self)","calls":[],"doc":"Test split detection when directory exists but is empty."},{"name":"test_default_path_parameter","line":145,"signature":"(self)","calls":[],"doc":"Test detect_index_format with default path (cwd)."},{"name":"test_performance_under_100ms","line":163,"signature":"(self)","calls":[],"doc":"Test format detection completes in under 100ms (NFR)."}],"doc":"Test format detection logic (AC#1)."}],"imports":["json","tempfile","unittest","pathlib","project_index","shutil","os","time"]},"scripts/test_configuration.py":{"language":"python","functions":[{"name":"run_all_tests","line":394,"signature":"()","calls":[],"doc":"Run all configuration tests."}],"classes":[{"name":"TestLoadConfiguration","line":30,"bases":[],"methods":[{"name":"setUp","line":33,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":40,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_valid_config_all_fields","line":45,"signature":"(self)","calls":[],"doc":"Test loading configuration with all fields present."},{"name":"test_load_config_missing_file","line":63,"signature":"(self)","calls":[],"doc":"Test loading when config file doesn't exist (should return empty dict)."},{"name":"test_load_config_invalid_json","line":70,"signature":"(self)","calls":[],"doc":"Test loading corrupted JSON (should return empty dict with warning)."},{"name":"test_load_config_invalid_mode","line":79,"signature":"(self)","calls":[],"doc":"Test loading with invalid mode value (should remove invalid field)."},{"name":"test_load_config_invalid_threshold","line":89,"signature":"(self)","calls":[],"doc":"Test loading with invalid threshold (should remove invalid field)."},{"name":"test_load_config_threshold_string","line":99,"signature":"(self)","calls":[],"doc":"Test loading with threshold as string (should remove invalid field)."},{"name":"test_load_config_mode_auto","line":109,"signature":"(self)","calls":[],"doc":"Test loading with mode='auto' (valid, should preserve)."},{"name":"test_load_config_mode_single","line":119,"signature":"(self)","calls":[],"doc":"Test loading with mode='single' (valid, should preserve)."},{"name":"test_load_config_partial_fields","line":129,"signature":"(self)","calls":[],"doc":"Test loading with only some fields present."},{"name":"test_load_config_performance","line":140,"signature":"(self)","calls":[],"doc":"Test configuration loading completes in <100ms (NFR)."}],"doc":"Test configuration file loading (AC#1, #2, #3)."},{"name":"TestConfigurationPrecedence","line":154,"bases":[],"methods":[{"name":"setUp","line":157,"signature":"(self)","calls":[],"doc":"Create temporary directory and config file."},{"name":"tearDown","line":172,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_cli_mode_overrides_config","line":180,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test CLI --mode flag overrides config file mode."},{"name":"test_cli_threshold_overrides_config","line":198,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test CLI --threshold flag overrides config file threshold."},{"name":"test_config_file_used_when_no_cli_flags","line":213,"signature":"(self)","calls":[],"doc":"Test config file values used when no CLI flags provided."}],"doc":"Test configuration precedence: CLI > config file > defaults (AC#1, #2, #3)."},{"name":"TestModeSelection","line":221,"bases":[],"methods":[{"name":"setUp","line":224,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":231,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_mode_split_forces_split_format","line":239,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test --mode split always generates split format (AC#2)."},{"name":"test_mode_single_forces_single_format","line":253,"signature":"(self, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test --mode single always generates single-file format (AC#1)."},{"name":"test_mode_auto_respects_threshold","line":270,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test --mode auto uses threshold for decision (AC#3)."},{"name":"test_mode_auto_triggers_split_above_threshold","line":288,"signature":"(self, mock_git_files, mock_summary, mock_generate)","calls":[],"doc":"Test --mode auto triggers split when file count exceeds threshold."}],"doc":"Test mode selection logic (AC#1, #2, #3)."},{"name":"TestCustomThreshold","line":300,"bases":[],"methods":[{"name":"setUp","line":303,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":310,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_custom_threshold_via_cli","line":319,"signature":"(self, mock_git_files, mock_summary, mock_generate)","calls":[],"doc":"Test custom threshold via --threshold flag."},{"name":"test_config_file_threshold","line":337,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test custom threshold from config file."}],"doc":"Test custom threshold configuration (AC#3)."},{"name":"TestBackwardCompatibility","line":356,"bases":[],"methods":[{"name":"setUp","line":359,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":366,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_legacy_format_split_flag","line":374,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test legacy --format=split flag still works."},{"name":"test_legacy_split_flag","line":385,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test legacy --split flag still works."}],"doc":"Test backward compatibility with legacy flags."}],"imports":["json","os","shutil","tempfile","time","unittest","pathlib","unittest.mock","sys","project_index"]},"scripts/test_doc_classifier.py":{"language":"python","functions":[{"name":"run_all_tests","line":253,"signature":"()","calls":[],"doc":"Run all test suites."}],"classes":[{"name":"TestClassifyDocumentation","line":20,"bases":[],"methods":[{"name":"test_critical_tier_patterns","line":23,"signature":"(self)","calls":[],"doc":"AC1: Classification logic identifies critical docs."},{"name":"test_standard_tier_patterns","line":41,"signature":"(self)","calls":[],"doc":"AC2: Classification identifies standard docs."},{"name":"test_archive_tier_patterns","line":58,"signature":"(self)","calls":[],"doc":"AC3: Classification identifies archive docs."},{"name":"test_default_tier_fallback","line":75,"signature":"(self)","calls":[],"doc":"Test default tier assignment for unmatched files."},{"name":"test_custom_tier_rules_extend_defaults","line":90,"signature":"(self)","calls":[],"doc":"AC4: Classification rules are configurable via config file."},{"name":"test_custom_config_invalid_format","line":117,"signature":"(self)","calls":[],"doc":"Test graceful handling of invalid config."},{"name":"test_config_none","line":134,"signature":"(self)","calls":[],"doc":"Test classification with None config."},{"name":"test_config_empty_dict","line":139,"signature":"(self)","calls":[],"doc":"Test classification with empty config dict."},{"name":"test_path_normalization","line":144,"signature":"(self)","calls":[],"doc":"Test that paths are normalized for consistent matching."},{"name":"test_case_sensitivity","line":157,"signature":"(self)","calls":[],"doc":"Test that pattern matching handles case correctly."},{"name":"test_tier_rules_structure","line":169,"signature":"(self)","calls":[],"doc":"Test that TIER_RULES constant has expected structure."}],"doc":"Test the classify_documentation function."},{"name":"TestIntegrationWithRealFiles","line":185,"bases":[],"methods":[{"name":"test_with_temporary_files","line":188,"signature":"(self)","calls":[],"doc":"Test classification with actual files in temp directory."},{"name":"test_relative_to_cwd","line":213,"signature":"(self)","calls":[],"doc":"Test classification of files relative to current working directory."},{"name":"test_classification_performance","line":232,"signature":"(self)","calls":[],"doc":"Test that classification is fast (< 1ms per file)."}],"doc":"Integration tests with actual file system."}],"imports":["unittest","pathlib","tempfile","os","doc_classifier","time","sys"]},"scripts/test_git_metadata.py":{"language":"python","functions":[{"name":"run_all_tests","line":412,"signature":"()","calls":[],"doc":"Run all test suites."}],"classes":[{"name":"TestExtractGitMetadata","line":32,"bases":[],"methods":[{"name":"setUp","line":35,"signature":"(self)","calls":[],"doc":"Create a temporary git repository for testing."},{"name":"tearDown","line":58,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_extract_commit_hash","line":62,"signature":"(self)","calls":[],"doc":"AC#1: Extract commit hash from git log."},{"name":"test_extract_author_email","line":70,"signature":"(self)","calls":[],"doc":"AC#1: Extract author email from git log."},{"name":"test_extract_commit_date","line":77,"signature":"(self)","calls":[],"doc":"AC#1: Extract commit date in ISO8601 format."},{"name":"test_extract_commit_message","line":86,"signature":"(self)","calls":[],"doc":"AC#1: Extract commit message."},{"name":"test_extract_pr_number_from_message","line":93,"signature":"(self)","calls":[],"doc":"AC#2: Extract PR number from commit message."},{"name":"test_extract_lines_changed","line":99,"signature":"(self)","calls":[],"doc":"AC#1: Extract lines changed from git diff."},{"name":"test_recency_days_calculation","line":107,"signature":"(self)","calls":[],"doc":"AC#1: Calculate recency days from commit date."},{"name":"test_caching_mechanism","line":116,"signature":"(self)","calls":[],"doc":"AC#5: Verify caching avoids duplicate git queries."},{"name":"test_fallback_to_mtime_when_git_unavailable","line":136,"signature":"(self)","calls":[],"doc":"AC#3: Graceful fallback to filesystem mtime when git unavailable."},{"name":"test_multiple_commits_returns_latest","line":160,"signature":"(self)","calls":[],"doc":"Verify extraction returns data from the most recent commit."}],"doc":"Test the main extract_git_metadata function."},{"name":"TestPRNumberExtraction","line":180,"bases":[],"methods":[{"name":"test_parse_pr_with_hash","line":183,"signature":"(self)","calls":[],"doc":"AC#2: Extract PR number from #123 pattern."},{"name":"test_parse_pr_without_parens","line":187,"signature":"(self)","calls":[],"doc":"AC#2: Extract PR number from #456 pattern."},{"name":"test_parse_pr_with_prefix","line":191,"signature":"(self)","calls":[],"doc":"AC#2: Extract PR number from PR #789 pattern."},{"name":"test_no_pr_in_message","line":195,"signature":"(self)","calls":[],"doc":"AC#2: Return None when no PR number found."},{"name":"test_multiple_pr_numbers_returns_first","line":200,"signature":"(self)","calls":[],"doc":"Return first PR number when multiple are present."},{"name":"test_empty_message","line":204,"signature":"(self)","calls":[],"doc":"Handle empty commit message gracefully."}],"doc":"Test PR number parsing from commit messages."},{"name":"TestRecencyCalculation","line":210,"bases":[],"methods":[{"name":"test_calculate_recency_today","line":213,"signature":"(self)","calls":[],"doc":"Test recency for commit made today."},{"name":"test_calculate_recency_yesterday","line":219,"signature":"(self)","calls":[],"doc":"Test recency for commit made yesterday."},{"name":"test_calculate_recency_week_ago","line":225,"signature":"(self)","calls":[],"doc":"Test recency for commit made a week ago."},{"name":"test_calculate_recency_invalid_date","line":231,"signature":"(self)","calls":[],"doc":"Handle invalid date gracefully."},{"name":"test_calculate_recency_with_timezone","line":236,"signature":"(self)","calls":[],"doc":"Handle dates with timezone info correctly."}],"doc":"Test recency days calculation."},{"name":"TestFallbackToMtime","line":244,"bases":[],"methods":[{"name":"test_fallback_returns_valid_structure","line":247,"signature":"(self)","calls":[],"doc":"AC#3: Fallback returns proper metadata structure."},{"name":"test_fallback_nonexistent_file","line":275,"signature":"(self)","calls":[],"doc":"Handle nonexistent file gracefully."}],"doc":"Test fallback behavior when git unavailable."},{"name":"TestIntegrationWithProjectIndex","line":285,"bases":[],"methods":[{"name":"setUp","line":288,"signature":"(self)","calls":[],"doc":"Create a temporary git repository with multiple files."},{"name":"tearDown","line":312,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_extract_metadata_for_all_files","line":316,"signature":"(self)","calls":[],"doc":"AC#4: Git metadata included for all files."}],"doc":"Integration tests with project_index.py."},{"name":"TestPerformance","line":338,"bases":[],"methods":[{"name":"setUp","line":341,"signature":"(self)","calls":[],"doc":"Create a larger temporary git repository."},{"name":"tearDown","line":365,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_extraction_performance_under_5_seconds","line":369,"signature":"(self)","calls":[],"doc":"AC#5: Git extraction adds <5 seconds overhead for 100 files."}],"doc":"Test performance requirements."},{"name":"TestBackwardCompatibility","line":390,"bases":[],"methods":[{"name":"test_metadata_fields_optional","line":393,"signature":"(self)","calls":[],"doc":"Verify system handles missing git metadata gracefully."}],"doc":"Test backward compatibility."}],"imports":["json","os","subprocess","tempfile","time","unittest","datetime","pathlib","git_metadata","sys"]},"scripts/test_index_analyzer_agent.py":{"language":"python","functions":[{"name":"test_split_architecture_detection","line":24,"signature":"()","calls":[],"doc":"Test AC#1: Agent loads core index first and detects split architecture presence"},{"name":"test_relevance_scoring","line":63,"signature":"()","calls":[],"doc":"Test AC#2: Agent performs relevance scoring on core index to identify relevant modules"},{"name":"test_lazy_loading","line":120,"signature":"()","calls":[],"doc":"Test AC#3: Agent lazy-loads top 3-5 relevant detail modules based on query"},{"name":"test_response_format","line":162,"signature":"()","calls":[],"doc":"Test AC#4: Agent provides response combining core index structure + detail module content"},{"name":"test_verbose_logging","line":209,"signature":"()","calls":[],"doc":"Test AC#5: Agent logs which modules were loaded (when verbose flag used)"},{"name":"test_agent_analysis_legacy_format","line":239,"signature":"()","calls":[],"doc":""},{"name":"test_agent_migration_suggestions","line":357,"signature":"()","calls":[],"doc":""},{"name":"test_agent_split_format_lazy_loading","line":415,"signature":"()","calls":[],"doc":""},{"name":"run_all_tests","line":524,"signature":"()","calls":[],"doc":"Run all acceptance criteria tests"}],"classes":[],"imports":["json","os","sys","pathlib","typing","loader"]},"scripts/test_loader.py":{"language":"python","functions":[],"classes":[{"name":"TestLoadDetailModule","line":24,"bases":[],"methods":[{"name":"setUp","line":27,"signature":"(self)","calls":[],"doc":"Create temporary directory and test module files."},{"name":"tearDown","line":59,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_valid_module","line":63,"signature":"(self)","calls":[],"doc":"Test loading a valid module returns correct data."},{"name":"test_load_nonexistent_module","line":72,"signature":"(self)","calls":[],"doc":"Test loading nonexistent module raises FileNotFoundError."},{"name":"test_load_invalid_json","line":80,"signature":"(self)","calls":[],"doc":"Test loading module with invalid JSON raises JSONDecodeError."},{"name":"test_load_incomplete_module","line":87,"signature":"(self)","calls":[],"doc":"Test loading module missing required fields raises ValueError."},{"name":"test_invalid_module_name_format","line":96,"signature":"(self)","calls":[],"doc":"Test invalid module name format raises ValueError."},{"name":"test_valid_module_name_formats","line":111,"signature":"(self)","calls":[],"doc":"Test valid module name formats are accepted."},{"name":"test_default_index_dir","line":137,"signature":"(self)","calls":[],"doc":"Test default index_dir uses PROJECT_INDEX.d/ in cwd."},{"name":"test_performance_under_500ms","line":153,"signature":"(self)","calls":[],"doc":"Test module loading completes in under 500ms (NFR001)."}],"doc":"Test load_detail_module function."},{"name":"TestFindModuleForFile","line":165,"bases":[],"methods":[{"name":"setUp","line":168,"signature":"(self)","calls":[],"doc":"Create test core index."},{"name":"test_find_existing_file","line":187,"signature":"(self)","calls":[],"doc":"Test finding file that exists in a module."},{"name":"test_find_file_with_leading_slash","line":195,"signature":"(self)","calls":[],"doc":"Test finding file with ./ prefix normalizes correctly."},{"name":"test_file_not_found","line":200,"signature":"(self)","calls":[],"doc":"Test file not in any module raises ValueError."},{"name":"test_invalid_core_index_missing_modules","line":208,"signature":"(self)","calls":[],"doc":"Test core_index without 'modules' or 'f' keys raises ValueError."},{"name":"test_invalid_core_index_type","line":217,"signature":"(self)","calls":[],"doc":"Test non-dict core_index raises TypeError."},{"name":"test_invalid_file_path_type","line":224,"signature":"(self)","calls":[],"doc":"Test non-string file_path raises TypeError."},{"name":"test_core_index_files_as_dict","line":231,"signature":"(self)","calls":[],"doc":"Test handling core_index with files as dict (not list)."}],"doc":"Test find_module_for_file function."},{"name":"TestLoadDetailByPath","line":248,"bases":[],"methods":[{"name":"setUp","line":251,"signature":"(self)","calls":[],"doc":"Create temporary directory and test files."},{"name":"tearDown","line":278,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_by_valid_path","line":282,"signature":"(self)","calls":[],"doc":"Test loading module by valid file path."},{"name":"test_load_by_nonexistent_path","line":293,"signature":"(self)","calls":[],"doc":"Test loading by nonexistent file path raises ValueError."},{"name":"test_integration_with_find_module","line":304,"signature":"(self)","calls":[],"doc":"Test that load_detail_by_path correctly uses find_module_for_file."}],"doc":"Test load_detail_by_path function."},{"name":"TestLoadMultipleModules","line":317,"bases":[],"methods":[{"name":"setUp","line":320,"signature":"(self)","calls":[],"doc":"Create temporary directory and test modules."},{"name":"tearDown","line":336,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_all_valid_modules","line":340,"signature":"(self)","calls":[],"doc":"Test loading multiple valid modules."},{"name":"test_load_with_partial_failures","line":357,"signature":"(self)","calls":[],"doc":"Test batch loading with mixed valid/invalid modules."},{"name":"test_load_all_invalid_modules","line":374,"signature":"(self)","calls":[],"doc":"Test batch loading with all invalid modules returns empty dict."},{"name":"test_load_empty_list","line":387,"signature":"(self)","calls":[],"doc":"Test loading empty list returns empty dict."},{"name":"test_invalid_input_type","line":394,"signature":"(self)","calls":[],"doc":"Test non-list input raises TypeError."},{"name":"test_warnings_for_failed_modules","line":401,"signature":"(self)","calls":[],"doc":"Test that warnings are issued for failed module loads."}],"doc":"Test load_multiple_modules function."},{"name":"TestIntegrationWithRealProject","line":416,"bases":[],"methods":[{"name":"setUp","line":419,"signature":"(self)","calls":[],"doc":"Check if real PROJECT_INDEX.d/ exists."},{"name":"test_load_real_scripts_module","line":434,"signature":"(self)","calls":[],"doc":"Test loading actual scripts module generated by Story 1.3."},{"name":"test_load_by_real_file_path","line":447,"signature":"(self)","calls":[],"doc":""},{"name":"test_batch_load_real_modules","line":480,"signature":"(self)","calls":[],"doc":"Test batch loading real modules from project."}],"doc":"Integration tests using actual PROJECT_INDEX.d/ from Story 1.3."}],"imports":["unittest","json","tempfile","time","pathlib","unittest.mock","warnings","loader"]},"scripts/test_migration.py":{"language":"python","functions":[{"name":"run_all_tests","line":447,"signature":"()","calls":[],"doc":"Run all migration tests."}],"classes":[{"name":"TestCreateBackup","line":34,"bases":[],"methods":[{"name":"setUp","line":37,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":43,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_backup_creation_with_timestamp","line":47,"signature":"(self)","calls":[],"doc":"Test AC#3: Backup created with timestamp."},{"name":"test_backup_preserves_permissions","line":63,"signature":"(self)","calls":[],"doc":"Test AC#3: Backup preserves file permissions."},{"name":"test_backup_failure_on_nonexistent_file","line":75,"signature":"(self)","calls":[],"doc":"Test backup fails gracefully if source doesn't exist."}],"doc":"Test backup creation mechanism (AC#3)."},{"name":"TestExtractLegacyData","line":83,"bases":[],"methods":[{"name":"setUp","line":86,"signature":"(self)","calls":[],"doc":"Create temporary directory and test index."},{"name":"tearDown","line":91,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_extract_valid_legacy_index","line":95,"signature":"(self)","calls":[],"doc":"Test extracting valid legacy index data."},{"name":"test_extract_nonexistent_index","line":111,"signature":"(self)","calls":[],"doc":"Test extraction fails if index doesn't exist."},{"name":"test_extract_corrupted_json","line":118,"signature":"(self)","calls":[],"doc":"Test extraction fails on corrupted JSON."}],"doc":"Test legacy data extraction (AC#2)."},{"name":"TestValidateMigrationIntegrity","line":126,"bases":[],"methods":[{"name":"test_validation_passes_with_matching_data","line":129,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation passes when all data preserved."},{"name":"test_validation_fails_on_missing_files","line":176,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation fails if files are missing."},{"name":"test_validation_fails_on_function_count_mismatch","line":201,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation fails if function count doesn't match."}],"doc":"Test migration integrity validation (AC#4)."},{"name":"TestRollbackMigration","line":230,"bases":[],"methods":[{"name":"setUp","line":233,"signature":"(self)","calls":[],"doc":"Create temporary directory and test files."},{"name":"tearDown","line":248,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_rollback_restores_backup","line":252,"signature":"(self)","calls":[],"doc":"Test AC#5: Rollback restores original from backup."},{"name":"test_rollback_cleans_up_detail_directory","line":260,"signature":"(self)","calls":[],"doc":"Test AC#5: Rollback removes partial split artifacts."},{"name":"test_rollback_handles_missing_backup_gracefully","line":267,"signature":"(self)","calls":[],"doc":"Test rollback doesn't fail if backup missing."}],"doc":"Test rollback mechanism (AC#5)."},{"name":"TestMigrateToSplitFormat","line":275,"bases":[],"methods":[{"name":"setUp","line":278,"signature":"(self)","calls":[],"doc":"Create temporary directory with legacy index."},{"name":"tearDown","line":309,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_migrate_creates_split_format","line":314,"signature":"(self)","calls":[],"doc":"Test AC#1: Migration converts legacy \u2192 split format."},{"name":"test_migrate_creates_backup","line":331,"signature":"(self)","calls":[],"doc":"Test AC#3: Migration creates backup before converting."},{"name":"test_migrate_preserves_data","line":345,"signature":"(self)","calls":[],"doc":"Test AC#2: Migration preserves all data."},{"name":"test_migrate_validates_integrity","line":368,"signature":"(self)","calls":[],"doc":"Test AC#4: Migration validates data integrity."},{"name":"test_migrate_already_split_format","line":376,"signature":"(self)","calls":[],"doc":"Test migration detects already-split format and exits gracefully."},{"name":"test_migrate_nonexistent_index","line":387,"signature":"(self)","calls":[],"doc":"Test AC#5: Clear failure message when no index exists."},{"name":"test_migrate_performance_under_10_seconds","line":396,"signature":"(self)","calls":[],"doc":"Test NFR: Migration completes in <10 seconds."}],"doc":"Integration tests for full migration workflow (AC#1-5)."},{"name":"TestMigrationCommandLineInterface","line":405,"bases":[],"methods":[{"name":"setUp","line":408,"signature":"(self)","calls":[],"doc":"Create temporary directory with legacy index."},{"name":"tearDown","line":425,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_migrate_flag_triggers_migration","line":431,"signature":"(self)","calls":[],"doc":"Test AC#1: --migrate flag triggers migration workflow."}],"doc":"Test --migrate flag integration (AC#1)."}],"imports":["json","os","shutil","tempfile","time","unittest","pathlib","unittest.mock","project_index","project_index","sys"]},"scripts/test_relevance.py":{"language":"python","functions":[{"name":"run_all_tests","line":547,"signature":"()","calls":[],"doc":"Run all tests and return results."}],"classes":[{"name":"TestFilterFilesByRecency","line":26,"bases":[],"methods":[{"name":"test_filter_files_by_7_day_window","line":29,"signature":"(self)","calls":[],"doc":"Verify 7-day filtering returns only recent files."},{"name":"test_filter_files_by_30_day_window","line":45,"signature":"(self)","calls":[],"doc":"Verify 30-day filtering includes medium-aged files."},{"name":"test_filter_files_by_90_day_window","line":61,"signature":"(self)","calls":[],"doc":"Verify 90-day filtering includes all but very old files."},{"name":"test_filter_handles_missing_git_metadata","line":77,"signature":"(self)","calls":[],"doc":"Files without git metadata are excluded from results."},{"name":"test_filter_empty_results","line":91,"signature":"(self)","calls":[],"doc":"No files match threshold returns empty list."},{"name":"test_filter_empty_input_files","line":103,"signature":"(self)","calls":[],"doc":"Empty file list returns empty result."},{"name":"test_filter_empty_git_metadata","line":108,"signature":"(self)","calls":[],"doc":"Empty git metadata returns empty result."},{"name":"test_filter_handles_path_normalization","line":114,"signature":"(self)","calls":[],"doc":"Filter handles leading ./ in file paths."},{"name":"test_filter_boundary_conditions","line":128,"signature":"(self)","calls":[],"doc":"Test exact boundary at threshold (7 days exactly)."}],"doc":"Test temporal filtering by recency threshold."},{"name":"TestRelevanceScorer","line":143,"bases":[],"methods":[{"name":"setUp","line":146,"signature":"(self)","calls":[],"doc":"Initialize scorer with default weights."},{"name":"test_explicit_file_ref_highest_score","line":150,"signature":"(self)","calls":[],"doc":"Explicit file references receive 10x weight (highest priority)."},{"name":"test_temporal_recent_7day_5x_weight","line":164,"signature":"(self)","calls":[],"doc":"Files changed in last 7 days get 5x weight."},{"name":"test_temporal_medium_30day_2x_weight","line":180,"signature":"(self)","calls":[],"doc":"Files changed in last 30 days (but not 7) get 2x weight."},{"name":"test_keyword_match_1x_weight","line":196,"signature":"(self)","calls":[],"doc":"Keyword matches get 1x weight."},{"name":"test_combined_scoring_all_signals","line":210,"signature":"(self)","calls":[],"doc":"Multiple signals combine correctly."},{"name":"test_no_temporal_boost_for_old_files","line":226,"signature":"(self)","calls":[],"doc":"Files older than 30 days receive no temporal boost."},{"name":"test_score_module_empty_module","line":242,"signature":"(self)","calls":[],"doc":"Empty module returns score of 0."},{"name":"test_score_module_missing_files_key","line":249,"signature":"(self)","calls":[],"doc":"Module without 'files' key returns score of 0."},{"name":"test_score_multiple_files_in_module","line":256,"signature":"(self)","calls":[],"doc":"Score accumulates across multiple files in module."}],"doc":"Test multi-signal relevance scoring engine."},{"name":"TestRelevanceScorerConfiguration","line":288,"bases":[],"methods":[{"name":"test_load_default_weights","line":291,"signature":"(self)","calls":[],"doc":"Default weights used when no config provided."},{"name":"test_load_custom_weights_from_config","line":299,"signature":"(self)","calls":[],"doc":"Custom weights override defaults."},{"name":"test_invalid_config_falls_back_to_defaults","line":315,"signature":"(self)","calls":[],"doc":"Invalid config gracefully falls back to defaults."},{"name":"test_empty_config","line":323,"signature":"(self)","calls":[],"doc":"Empty config uses defaults."},{"name":"test_custom_weights_affect_scoring","line":328,"signature":"(self)","calls":[],"doc":"Custom weights actually affect score calculation."}],"doc":"Test configurable temporal weights."},{"name":"TestScoreAllModules","line":347,"bases":[],"methods":[{"name":"setUp","line":350,"signature":"(self)","calls":[],"doc":"Initialize scorer."},{"name":"test_score_all_modules_sorts_by_relevance","line":354,"signature":"(self)","calls":[],"doc":"Modules are sorted by score descending (highest first)."},{"name":"test_score_all_modules_excludes_zero_scores","line":377,"signature":"(self)","calls":[],"doc":"Modules with zero score are excluded from results."},{"name":"test_score_all_modules_empty_input","line":392,"signature":"(self)","calls":[],"doc":"Empty modules dict returns empty list."}],"doc":"Test scoring and sorting of multiple modules."},{"name":"TestPerformance","line":398,"bases":[],"methods":[{"name":"test_scoring_1000_modules_under_100ms","line":401,"signature":"(self)","calls":[],"doc":"Scoring 1,000 modules completes in <100ms (AC requirement)."},{"name":"test_filtering_10000_files_under_1s","line":437,"signature":"(self)","calls":[],"doc":"Filtering 10,000 files completes in <1 second."}],"doc":"Performance validation tests."},{"name":"TestIntegration","line":461,"bases":[],"methods":[{"name":"test_end_to_end_temporal_query","line":464,"signature":"(self)","calls":[],"doc":"Full workflow from temporal query to scored results."},{"name":"test_integration_with_real_structure","line":511,"signature":"(self)","calls":[],"doc":"Test with realistic PROJECT_INDEX.json structure."}],"doc":"Integration tests with core index structure."}],"imports":["json","os","sys","tempfile","time","unittest","pathlib","typing","scripts"]},"scripts/test_tiered_storage.py":{"language":"python","functions":[{"name":"run_all_tests","line":465,"signature":"()","calls":[],"doc":"Run all tiered storage tests"}],"classes":[{"name":"TestTieredStorageAC1","line":32,"bases":[],"methods":[{"name":"setUp","line":35,"signature":"(self)","calls":[],"doc":"Create temporary test project with mixed tier docs"},{"name":"tearDown","line":59,"signature":"(self)","calls":[],"doc":"Clean up temp directory"},{"name":"test_core_index_contains_only_critical_tier","line":63,"signature":"(self)","calls":[],"doc":"Core index should contain only critical docs by default"},{"name":"test_tier_counts_in_stats","line":92,"signature":"(self)","calls":[],"doc":"Stats should track all tier counts correctly"}],"doc":"AC #1: Core index contains only critical tier by default"},{"name":"TestTieredStorageAC2","line":105,"bases":[],"methods":[{"name":"setUp","line":108,"signature":"(self)","calls":[],"doc":"Create test project with docs organized by module"},{"name":"tearDown","line":128,"signature":"(self)","calls":[],"doc":""},{"name":"test_detail_modules_contain_standard_tier","line":131,"signature":"(self)","calls":[],"doc":"Detail modules should have doc_standard section populated"},{"name":"test_detail_modules_contain_archive_tier","line":147,"signature":"(self)","calls":[],"doc":"Detail modules should have doc_archive section populated"},{"name":"test_docs_organized_by_module","line":163,"signature":"(self)","calls":[],"doc":"Standard/archive docs should be organized by module directory"}],"doc":"AC #2: Detail modules contain standard and archive tiers"},{"name":"TestTieredStorageAC3","line":179,"bases":[],"methods":[{"name":"setUp","line":182,"signature":"(self)","calls":[],"doc":"Create test project with config file"},{"name":"tearDown","line":196,"signature":"(self)","calls":[],"doc":""},{"name":"test_config_include_all_tiers_true","line":199,"signature":"(self)","calls":[],"doc":"When include_all_doc_tiers: true, all tiers should be in core"},{"name":"test_config_include_all_tiers_false_default","line":217,"signature":"(self)","calls":[],"doc":"When include_all_doc_tiers: false (default), only critical in core"},{"name":"test_config_default_behavior_no_config","line":230,"signature":"(self)","calls":[],"doc":"Without config, should default to false (critical only)"}],"doc":"AC #3: Configuration option to include all tiers in core"},{"name":"TestTieredStorageAC4","line":241,"bases":[],"methods":[{"name":"setUp","line":244,"signature":"(self)","calls":[],"doc":"Create test project with tiered docs"},{"name":"tearDown","line":263,"signature":"(self)","calls":[],"doc":""},{"name":"test_critical_docs_loaded_by_default","line":266,"signature":"(self)","calls":[],"doc":"Core index should contain critical docs accessible immediately"},{"name":"test_load_standard_tier_from_module","line":275,"signature":"(self)","calls":[],"doc":"Agent can request standard tier docs from specific module"},{"name":"test_load_archive_tier_from_module","line":284,"signature":"(self)","calls":[],"doc":"Agent can request archive tier docs from specific module"},{"name":"test_load_tier_all_modules","line":293,"signature":"(self)","calls":[],"doc":"Agent can request tier docs from all modules aggregated"}],"doc":"AC #4: Agent loads critical by default, can request other tiers"},{"name":"TestTieredStorageAC5","line":311,"bases":[],"methods":[{"name":"setUp","line":314,"signature":"(self)","calls":[],"doc":"Create doc-heavy test project"},{"name":"tearDown","line":341,"signature":"(self)","calls":[],"doc":""},{"name":"test_compression_ratio_60_to_80_percent","line":344,"signature":"(self)","calls":[],"doc":"Tiered storage should achieve 55-80% compression for doc-heavy projects (adjusted for git metadata)"}],"doc":"AC #5: Doc-heavy project shows 60-80% compression"},{"name":"TestBackwardCompatibility","line":370,"bases":[],"methods":[{"name":"setUp","line":373,"signature":"(self)","calls":[],"doc":""},{"name":"tearDown","line":377,"signature":"(self)","calls":[],"doc":""},{"name":"test_load_module_without_doc_tiers","line":380,"signature":"(self)","calls":[],"doc":"Loader should handle modules without doc_standard/doc_archive gracefully"},{"name":"test_load_doc_tier_empty_modules","line":403,"signature":"(self)","calls":[],"doc":"load_doc_tier should handle modules without tier sections"}],"doc":"Backward compatibility: existing indices work without tiered docs"},{"name":"TestPerformance","line":424,"bases":[],"methods":[{"name":"setUp","line":427,"signature":"(self)","calls":[],"doc":""},{"name":"tearDown","line":431,"signature":"(self)","calls":[],"doc":""},{"name":"test_tier_filtering_performance","line":434,"signature":"(self)","calls":[],"doc":"Tier filtering should complete in <500ms for 1000 file project"}],"doc":"Performance validation: operations complete within target times"}],"imports":["json","os","shutil","tempfile","time","unittest","pathlib","typing","sys","project_index","loader","doc_classifier","sys"]}},"call_graph_local":[["build_reverse_call_graph","build_reverse_call_graph"],["analyze_impact","analyze_impact"],["analyze_impact","build_reverse_call_graph"],["map_functions_to_paths","map_functions_to_paths"],["format_impact_report","analyze_impact"],["format_impact_report","map_functions_to_paths"],["detect_mcp_tools","_is_claude_code_environment"],["detect_mcp_tools","detect_mcp_tools"],["get_cached_capabilities","detect_mcp_tools"],["get_cached_capabilities","get_cached_capabilities"],["reset_detection_cache","detect_mcp_tools"],["reset_detection_cache","reset_detection_cache"],["classify_documentation","classify_documentation"],["extract_git_metadata","_extract_from_git"],["extract_git_metadata","extract_git_metadata"],["_extract_from_git","_calculate_recency_days"],["_extract_from_git","_extract_lines_changed"],["_extract_from_git","_extract_pr_number"],["_extract_from_git","_fallback_to_mtime"],["_extract_pr_number","_extract_pr_number"],["_fallback_to_mtime","_calculate_recency_days"],["get_last_interactive_size","find_project_root"],["parse_index_flag","get_last_interactive_size"],["should_regenerate_index","calculate_files_hash"],["generate_index_at_size","calculate_files_hash"],["extract_python_signatures","extract_function_calls_python"],["extract_javascript_signatures","extract_function_calls_javascript"],["extract_shell_signatures","extract_function_calls_shell"],["load_gitignore_patterns","parse_gitignore"],["should_index_file","load_gitignore_patterns"],["should_index_file","matches_gitignore_pattern"],["load_detail_module","load_detail_module"],["find_module_for_file","find_module_for_file"],["load_detail_by_path","find_module_for_file"],["load_detail_by_path","load_detail_by_path"],["load_detail_by_path","load_detail_module"],["load_multiple_modules","load_detail_module"],["load_multiple_modules","load_multiple_modules"],["load_doc_tier","load_detail_module"],["load_doc_tier","load_doc_tier"],["generate_split_index","create_module_references"],["generate_split_index","generate_detail_modules"],["generate_split_index","generate_tree_structure"],["generate_split_index","organize_into_modules"],["build_index","generate_tree_structure"],["migrate_to_split_format","create_backup"],["migrate_to_split_format","detect_index_format"],["migrate_to_split_format","extract_legacy_data"],["migrate_to_split_format","generate_split_index"],["migrate_to_split_format","load_configuration"],["migrate_to_split_format","rollback_migration"],["migrate_to_split_format","validate_migration_integrity"],["filter_files_by_recency","filter_files_by_recency"]],"doc_standard":{},"doc_archive":{}}