{"module_id":"scripts","version":"2.0-split","modified":"2025-11-02T02:32:58.869145","files":{"scripts/find_python.sh":{"language":"shell","functions":[],"classes":[],"imports":[]},"scripts/i_flag_hook.py":{"language":"python","functions":[{"name":"find_project_root","line":23,"signature":"()","calls":[],"doc":"Find project root by looking for .git or common project markers."},{"name":"get_last_interactive_size","line":45,"signature":"()","calls":["find_project_root"],"doc":"Get the last remembered -i size from the index."},{"name":"parse_index_flag","line":66,"signature":"(prompt)","calls":["get_last_interactive_size"],"doc":"Parse -i or -ic flag with optional size."},{"name":"calculate_files_hash","line":104,"signature":"(project_root)","calls":[],"doc":"Calculate hash of non-ignored files to detect changes."},{"name":"should_regenerate_index","line":141,"signature":"(project_root, index_path, requested_size_k)","calls":["calculate_files_hash"],"doc":"Determine if index needs regeneration."},{"name":"generate_index_at_size","line":173,"signature":"(project_root, target_size_k, is_clipboard_mode=False)","calls":["calculate_files_hash"],"doc":"Generate index at specific token size."},{"name":"copy_to_clipboard","line":259,"signature":"(prompt, index_path)","calls":[],"doc":"Copy prompt, instructions, and index to clipboard for external AI."},{"name":"main","line":566,"signature":"()","calls":["copy_to_clipboard","find_project_root","generate_index_at_size","parse_index_flag","should_regenerate_index"],"doc":"Process UserPromptSubmit hook for -i and -ic flag detection."}],"classes":[],"imports":["json","sys","os","re","subprocess","hashlib","time","pathlib","datetime","sys","vm_client_network","vm_client","base64","pyperclip"]},"scripts/index_utils.py":{"language":"python","functions":[{"name":"extract_function_calls_python","line":74,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from Python code body."},{"name":"extract_function_calls_javascript","line":104,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from JavaScript/TypeScript code body."},{"name":"build_call_graph","line":132,"signature":"(functions: Dict, classes: Dict) -> Tuple[Dict, Dict]","calls":[],"doc":"Build bidirectional call graph from extracted functions and methods."},{"name":"extract_python_signatures","line":161,"signature":"(content: str) -> Dict[str, Dict]","calls":["extract_function_calls_python"],"doc":"Extract Python function and class signatures with full details for all files."},{"name":"extract_javascript_signatures","line":545,"signature":"(content: str) -> Dict[str, any]","calls":["extract_function_calls_javascript","pos_to_line"],"doc":"Extract JavaScript/TypeScript function and class signatures with full details."},{"name":"extract_function_calls_shell","line":906,"signature":"(body: str, all_functions: Set[str]) -> List[str]","calls":[],"doc":"Extract function calls from shell script body."},{"name":"extract_shell_signatures","line":928,"signature":"(content: str) -> Dict[str, any]","calls":["extract_function_calls_shell"],"doc":"Extract shell script function signatures and structure."},{"name":"extract_markdown_structure","line":1186,"signature":"(file_path: Path) -> Dict[str, List[str]]","calls":[],"doc":"Extract headers and architectural hints from markdown files."},{"name":"infer_file_purpose","line":1217,"signature":"(file_path: Path) -> Optional[str]","calls":[],"doc":"Infer the purpose of a file from its name and location."},{"name":"infer_directory_purpose","line":1240,"signature":"(path: Path, files_within: List[str]) -> Optional[str]","calls":[],"doc":"Infer directory purpose from naming patterns and contents."},{"name":"extract_lightweight_signature","line":1270,"signature":"(func_data: Dict, func_name: str) -> str","calls":[],"doc":""},{"name":"get_language_name","line":1288,"signature":"(extension: str) -> str","calls":[],"doc":"Get readable language name from extension."},{"name":"parse_gitignore","line":1299,"signature":"(gitignore_path: Path) -> List[str]","calls":[],"doc":"Parse a .gitignore file and return list of patterns."},{"name":"load_gitignore_patterns","line":1319,"signature":"(root_path: Path) -> Set[str]","calls":["parse_gitignore"],"doc":"Load all gitignore patterns from project root and merge with defaults."},{"name":"matches_gitignore_pattern","line":1342,"signature":"(path: Path, patterns: Set[str], root_path: Path) -> bool","calls":[],"doc":"Check if a path matches any gitignore pattern."},{"name":"should_index_file","line":1386,"signature":"(path: Path, root_path: Path = None) -> bool","calls":["load_gitignore_patterns","matches_gitignore_pattern"],"doc":"Check if we should index this file."},{"name":"get_git_files","line":1406,"signature":"(root_path: Path) -> Optional[List[Path]]","calls":[],"doc":""}],"classes":[],"imports":["re","fnmatch","pathlib","typing","subprocess"]},"scripts/loader.py":{"language":"python","functions":[{"name":"load_detail_module","line":20,"signature":"(module_name: str, index_dir: Optional[Path] = None) -> Dict","calls":["load_detail_module"],"doc":""},{"name":"find_module_for_file","line":104,"signature":"(file_path: str, core_index: Dict) -> str","calls":["find_module_for_file"],"doc":""},{"name":"load_detail_by_path","line":199,"signature":"(file_path: str, core_index: Dict, index_dir: Optional[Path] = None) -> Dict","calls":["find_module_for_file","load_detail_by_path","load_detail_module"],"doc":""},{"name":"load_multiple_modules","line":236,"signature":"(module_names: List[str], index_dir: Optional[Path] = None) -> Dict[str, Dict]","calls":["load_detail_module","load_multiple_modules"],"doc":""}],"classes":[],"imports":["pathlib","typing","json","logging","warnings"]},"scripts/project_index.py":{"language":"python","functions":[{"name":"detect_index_format","line":40,"signature":"(index_path: Path = None) -> str","calls":[],"doc":""},{"name":"load_configuration","line":77,"signature":"(config_path: Optional[Path] = None) -> Dict[str, any]","calls":[],"doc":""},{"name":"generate_tree_structure","line":139,"signature":"(root_path: Path, max_depth: int = MAX_TREE_DEPTH) -> List[str]","calls":["add_tree_level","should_include_dir"],"doc":"Generate a compact ASCII tree representation of the directory structure."},{"name":"generate_split_index","line":208,"signature":"(root_dir: str) -> Tuple[Dict, int]","calls":["create_module_references","extract_git_metadata","generate_detail_modules","generate_tree_structure","organize_into_modules"],"doc":""},{"name":"generate_detail_modules","line":439,"signature":"(files_data: Dict[str, Dict], modules: Dict[str, List[str]], root_path: Path, skip_details: bool = False) -> List[str]","calls":[],"doc":""},{"name":"build_index","line":594,"signature":"(root_dir: str) -> Tuple[Dict, int]","calls":["generate_tree_structure"],"doc":"Build the enhanced index with architectural awareness (legacy single-file format)."},{"name":"convert_to_enhanced_dense_format","line":889,"signature":"(index: Dict) -> Dict","calls":["truncate_doc"],"doc":"Convert to enhanced dense format that preserves all AI-relevant information."},{"name":"compress_if_needed","line":1014,"signature":"(dense_index: Dict, target_size: int = MAX_INDEX_SIZE) -> Dict","calls":[],"doc":"Compress dense index further if it exceeds size limit."},{"name":"extract_git_metadata","line":1145,"signature":"(file_path: Path, root_path: Path, cache: Dict) -> Dict","calls":["_fallback_to_mtime"],"doc":""},{"name":"_fallback_to_mtime","line":1207,"signature":"(file_path: Path) -> Dict","calls":[],"doc":"Fallback to file modification time when git is unavailable."},{"name":"organize_into_modules","line":1231,"signature":"(files: List[Path], root_path: Path, depth: int = 1) -> Dict[str, List[str]]","calls":[],"doc":""},{"name":"create_module_references","line":1269,"signature":"(modules: Dict[str, List[str]], functions: Dict[str, Dict]) -> Dict[str, Dict]","calls":[],"doc":""},{"name":"print_summary","line":1304,"signature":"(index: Dict, skipped_count: int)","calls":[],"doc":"Print a helpful summary of what was indexed."},{"name":"create_backup","line":1352,"signature":"(index_path: Path) -> Path","calls":[],"doc":""},{"name":"extract_legacy_data","line":1379,"signature":"(index_path: Path) -> Dict","calls":[],"doc":""},{"name":"validate_migration_integrity","line":1404,"signature":"(legacy_index: Dict, core_index: Dict, detail_modules: Dict[str, Dict]) -> bool","calls":[],"doc":""},{"name":"rollback_migration","line":1500,"signature":"(backup_path: Path, index_path: Path, detail_dir: Path)","calls":[],"doc":""},{"name":"migrate_to_split_format","line":1530,"signature":"(root_dir: str = '.', dry_run: bool = False) -> bool","calls":["create_backup","detect_index_format","extract_legacy_data","generate_split_index","rollback_migration","validate_migration_integrity"],"doc":""},{"name":"main","line":1744,"signature":"() -> None","calls":[],"doc":""}],"classes":[],"imports":["json","os","re","datetime","pathlib","typing","index_utils","index_utils","index_utils","index_utils","index_utils","subprocess","datetime","datetime","shutil","datetime","hashlib","shutil","shutil","datetime","argparse","sys","index_utils"]},"scripts/stop_hook.py":{"language":"python","functions":[{"name":"main","line":14,"signature":"()","calls":[],"doc":"Stop hook - regenerate index if PROJECT_INDEX.json exists."}],"classes":[],"imports":["json","sys","os","subprocess","pathlib"]},"scripts/test_backward_compat.py":{"language":"python","functions":[],"classes":[{"name":"TestDetectIndexFormat","line":17,"bases":[],"methods":[{"name":"setUp","line":20,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":26,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_legacy_format_no_directory","line":31,"signature":"(self)","calls":[],"doc":"Test detection of legacy format when PROJECT_INDEX.d/ doesn't exist."},{"name":"test_split_format_with_directory_and_version","line":47,"signature":"(self)","calls":[],"doc":"Test detection of split format when both directory and version present."},{"name":"test_legacy_format_with_old_version","line":68,"signature":"(self)","calls":[],"doc":"Test legacy detection when version is 1.0."},{"name":"test_legacy_format_missing_version_field","line":86,"signature":"(self)","calls":[],"doc":"Test legacy detection when version field is missing."},{"name":"test_legacy_format_empty_index_file","line":103,"signature":"(self)","calls":[],"doc":"Test legacy detection with empty/corrupted index file."},{"name":"test_legacy_format_corrupted_json","line":112,"signature":"(self)","calls":[],"doc":"Test legacy detection with corrupted JSON."},{"name":"test_legacy_format_index_file_not_exists","line":120,"signature":"(self)","calls":[],"doc":"Test legacy detection when index file doesn't exist."},{"name":"test_split_format_empty_directory","line":126,"signature":"(self)","calls":[],"doc":"Test split detection when directory exists but is empty."},{"name":"test_default_path_parameter","line":145,"signature":"(self)","calls":[],"doc":"Test detect_index_format with default path (cwd)."},{"name":"test_performance_under_100ms","line":163,"signature":"(self)","calls":[],"doc":"Test format detection completes in under 100ms (NFR)."}],"doc":"Test format detection logic (AC#1)."}],"imports":["json","tempfile","unittest","pathlib","project_index","shutil","os","time"]},"scripts/test_configuration.py":{"language":"python","functions":[{"name":"run_all_tests","line":394,"signature":"()","calls":[],"doc":"Run all configuration tests."}],"classes":[{"name":"TestLoadConfiguration","line":30,"bases":[],"methods":[{"name":"setUp","line":33,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":40,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_valid_config_all_fields","line":45,"signature":"(self)","calls":[],"doc":"Test loading configuration with all fields present."},{"name":"test_load_config_missing_file","line":63,"signature":"(self)","calls":[],"doc":"Test loading when config file doesn't exist (should return empty dict)."},{"name":"test_load_config_invalid_json","line":70,"signature":"(self)","calls":[],"doc":"Test loading corrupted JSON (should return empty dict with warning)."},{"name":"test_load_config_invalid_mode","line":79,"signature":"(self)","calls":[],"doc":"Test loading with invalid mode value (should remove invalid field)."},{"name":"test_load_config_invalid_threshold","line":89,"signature":"(self)","calls":[],"doc":"Test loading with invalid threshold (should remove invalid field)."},{"name":"test_load_config_threshold_string","line":99,"signature":"(self)","calls":[],"doc":"Test loading with threshold as string (should remove invalid field)."},{"name":"test_load_config_mode_auto","line":109,"signature":"(self)","calls":[],"doc":"Test loading with mode='auto' (valid, should preserve)."},{"name":"test_load_config_mode_single","line":119,"signature":"(self)","calls":[],"doc":"Test loading with mode='single' (valid, should preserve)."},{"name":"test_load_config_partial_fields","line":129,"signature":"(self)","calls":[],"doc":"Test loading with only some fields present."},{"name":"test_load_config_performance","line":140,"signature":"(self)","calls":[],"doc":"Test configuration loading completes in <100ms (NFR)."}],"doc":"Test configuration file loading (AC#1, #2, #3)."},{"name":"TestConfigurationPrecedence","line":154,"bases":[],"methods":[{"name":"setUp","line":157,"signature":"(self)","calls":[],"doc":"Create temporary directory and config file."},{"name":"tearDown","line":172,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_cli_mode_overrides_config","line":180,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test CLI --mode flag overrides config file mode."},{"name":"test_cli_threshold_overrides_config","line":198,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test CLI --threshold flag overrides config file threshold."},{"name":"test_config_file_used_when_no_cli_flags","line":213,"signature":"(self)","calls":[],"doc":"Test config file values used when no CLI flags provided."}],"doc":"Test configuration precedence: CLI > config file > defaults (AC#1, #2, #3)."},{"name":"TestModeSelection","line":221,"bases":[],"methods":[{"name":"setUp","line":224,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":231,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_mode_split_forces_split_format","line":239,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test --mode split always generates split format (AC#2)."},{"name":"test_mode_single_forces_single_format","line":253,"signature":"(self, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test --mode single always generates single-file format (AC#1)."},{"name":"test_mode_auto_respects_threshold","line":270,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test --mode auto uses threshold for decision (AC#3)."},{"name":"test_mode_auto_triggers_split_above_threshold","line":288,"signature":"(self, mock_git_files, mock_summary, mock_generate)","calls":[],"doc":"Test --mode auto triggers split when file count exceeds threshold."}],"doc":"Test mode selection logic (AC#1, #2, #3)."},{"name":"TestCustomThreshold","line":300,"bases":[],"methods":[{"name":"setUp","line":303,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":310,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_custom_threshold_via_cli","line":319,"signature":"(self, mock_git_files, mock_summary, mock_generate)","calls":[],"doc":"Test custom threshold via --threshold flag."},{"name":"test_config_file_threshold","line":337,"signature":"(self, mock_git_files, mock_summary, mock_compress, mock_convert, mock_build)","calls":[],"doc":"Test custom threshold from config file."}],"doc":"Test custom threshold configuration (AC#3)."},{"name":"TestBackwardCompatibility","line":356,"bases":[],"methods":[{"name":"setUp","line":359,"signature":"(self)","calls":[],"doc":"Create temporary directory."},{"name":"tearDown","line":366,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_legacy_format_split_flag","line":374,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test legacy --format=split flag still works."},{"name":"test_legacy_split_flag","line":385,"signature":"(self, mock_summary, mock_generate)","calls":[],"doc":"Test legacy --split flag still works."}],"doc":"Test backward compatibility with legacy flags."}],"imports":["json","os","shutil","tempfile","time","unittest","pathlib","unittest.mock","sys","project_index"]},"scripts/test_index_analyzer_agent.py":{"language":"python","functions":[{"name":"test_split_architecture_detection","line":24,"signature":"()","calls":[],"doc":"Test AC#1: Agent loads core index first and detects split architecture presence"},{"name":"test_relevance_scoring","line":63,"signature":"()","calls":[],"doc":"Test AC#2: Agent performs relevance scoring on core index to identify relevant modules"},{"name":"test_lazy_loading","line":120,"signature":"()","calls":[],"doc":"Test AC#3: Agent lazy-loads top 3-5 relevant detail modules based on query"},{"name":"test_response_format","line":162,"signature":"()","calls":[],"doc":"Test AC#4: Agent provides response combining core index structure + detail module content"},{"name":"test_verbose_logging","line":209,"signature":"()","calls":[],"doc":"Test AC#5: Agent logs which modules were loaded (when verbose flag used)"},{"name":"test_agent_analysis_legacy_format","line":239,"signature":"()","calls":[],"doc":""},{"name":"test_agent_migration_suggestions","line":357,"signature":"()","calls":[],"doc":""},{"name":"test_agent_split_format_lazy_loading","line":415,"signature":"()","calls":[],"doc":""},{"name":"run_all_tests","line":524,"signature":"()","calls":[],"doc":"Run all acceptance criteria tests"}],"classes":[],"imports":["json","os","sys","pathlib","typing","loader"]},"scripts/test_loader.py":{"language":"python","functions":[],"classes":[{"name":"TestLoadDetailModule","line":24,"bases":[],"methods":[{"name":"setUp","line":27,"signature":"(self)","calls":[],"doc":"Create temporary directory and test module files."},{"name":"tearDown","line":59,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_valid_module","line":63,"signature":"(self)","calls":[],"doc":"Test loading a valid module returns correct data."},{"name":"test_load_nonexistent_module","line":72,"signature":"(self)","calls":[],"doc":"Test loading nonexistent module raises FileNotFoundError."},{"name":"test_load_invalid_json","line":80,"signature":"(self)","calls":[],"doc":"Test loading module with invalid JSON raises JSONDecodeError."},{"name":"test_load_incomplete_module","line":87,"signature":"(self)","calls":[],"doc":"Test loading module missing required fields raises ValueError."},{"name":"test_invalid_module_name_format","line":96,"signature":"(self)","calls":[],"doc":"Test invalid module name format raises ValueError."},{"name":"test_valid_module_name_formats","line":111,"signature":"(self)","calls":[],"doc":"Test valid module name formats are accepted."},{"name":"test_default_index_dir","line":137,"signature":"(self)","calls":[],"doc":"Test default index_dir uses PROJECT_INDEX.d/ in cwd."},{"name":"test_performance_under_500ms","line":153,"signature":"(self)","calls":[],"doc":"Test module loading completes in under 500ms (NFR001)."}],"doc":"Test load_detail_module function."},{"name":"TestFindModuleForFile","line":165,"bases":[],"methods":[{"name":"setUp","line":168,"signature":"(self)","calls":[],"doc":"Create test core index."},{"name":"test_find_existing_file","line":187,"signature":"(self)","calls":[],"doc":"Test finding file that exists in a module."},{"name":"test_find_file_with_leading_slash","line":195,"signature":"(self)","calls":[],"doc":"Test finding file with ./ prefix normalizes correctly."},{"name":"test_file_not_found","line":200,"signature":"(self)","calls":[],"doc":"Test file not in any module raises ValueError."},{"name":"test_invalid_core_index_missing_modules","line":208,"signature":"(self)","calls":[],"doc":"Test core_index without 'modules' or 'f' keys raises ValueError."},{"name":"test_invalid_core_index_type","line":217,"signature":"(self)","calls":[],"doc":"Test non-dict core_index raises TypeError."},{"name":"test_invalid_file_path_type","line":224,"signature":"(self)","calls":[],"doc":"Test non-string file_path raises TypeError."},{"name":"test_core_index_files_as_dict","line":231,"signature":"(self)","calls":[],"doc":"Test handling core_index with files as dict (not list)."}],"doc":"Test find_module_for_file function."},{"name":"TestLoadDetailByPath","line":248,"bases":[],"methods":[{"name":"setUp","line":251,"signature":"(self)","calls":[],"doc":"Create temporary directory and test files."},{"name":"tearDown","line":278,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_by_valid_path","line":282,"signature":"(self)","calls":[],"doc":"Test loading module by valid file path."},{"name":"test_load_by_nonexistent_path","line":293,"signature":"(self)","calls":[],"doc":"Test loading by nonexistent file path raises ValueError."},{"name":"test_integration_with_find_module","line":304,"signature":"(self)","calls":[],"doc":"Test that load_detail_by_path correctly uses find_module_for_file."}],"doc":"Test load_detail_by_path function."},{"name":"TestLoadMultipleModules","line":317,"bases":[],"methods":[{"name":"setUp","line":320,"signature":"(self)","calls":[],"doc":"Create temporary directory and test modules."},{"name":"tearDown","line":336,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_load_all_valid_modules","line":340,"signature":"(self)","calls":[],"doc":"Test loading multiple valid modules."},{"name":"test_load_with_partial_failures","line":357,"signature":"(self)","calls":[],"doc":"Test batch loading with mixed valid/invalid modules."},{"name":"test_load_all_invalid_modules","line":374,"signature":"(self)","calls":[],"doc":"Test batch loading with all invalid modules returns empty dict."},{"name":"test_load_empty_list","line":387,"signature":"(self)","calls":[],"doc":"Test loading empty list returns empty dict."},{"name":"test_invalid_input_type","line":394,"signature":"(self)","calls":[],"doc":"Test non-list input raises TypeError."},{"name":"test_warnings_for_failed_modules","line":401,"signature":"(self)","calls":[],"doc":"Test that warnings are issued for failed module loads."}],"doc":"Test load_multiple_modules function."},{"name":"TestIntegrationWithRealProject","line":416,"bases":[],"methods":[{"name":"setUp","line":419,"signature":"(self)","calls":[],"doc":"Check if real PROJECT_INDEX.d/ exists."},{"name":"test_load_real_scripts_module","line":434,"signature":"(self)","calls":[],"doc":"Test loading actual scripts module generated by Story 1.3."},{"name":"test_load_by_real_file_path","line":447,"signature":"(self)","calls":[],"doc":""},{"name":"test_batch_load_real_modules","line":480,"signature":"(self)","calls":[],"doc":"Test batch loading real modules from project."}],"doc":"Integration tests using actual PROJECT_INDEX.d/ from Story 1.3."}],"imports":["unittest","json","tempfile","time","pathlib","unittest.mock","warnings","loader"]},"scripts/test_migration.py":{"language":"python","functions":[{"name":"run_all_tests","line":447,"signature":"()","calls":[],"doc":"Run all migration tests."}],"classes":[{"name":"TestCreateBackup","line":34,"bases":[],"methods":[{"name":"setUp","line":37,"signature":"(self)","calls":[],"doc":"Create temporary directory for test files."},{"name":"tearDown","line":43,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_backup_creation_with_timestamp","line":47,"signature":"(self)","calls":[],"doc":"Test AC#3: Backup created with timestamp."},{"name":"test_backup_preserves_permissions","line":63,"signature":"(self)","calls":[],"doc":"Test AC#3: Backup preserves file permissions."},{"name":"test_backup_failure_on_nonexistent_file","line":75,"signature":"(self)","calls":[],"doc":"Test backup fails gracefully if source doesn't exist."}],"doc":"Test backup creation mechanism (AC#3)."},{"name":"TestExtractLegacyData","line":83,"bases":[],"methods":[{"name":"setUp","line":86,"signature":"(self)","calls":[],"doc":"Create temporary directory and test index."},{"name":"tearDown","line":91,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_extract_valid_legacy_index","line":95,"signature":"(self)","calls":[],"doc":"Test extracting valid legacy index data."},{"name":"test_extract_nonexistent_index","line":111,"signature":"(self)","calls":[],"doc":"Test extraction fails if index doesn't exist."},{"name":"test_extract_corrupted_json","line":118,"signature":"(self)","calls":[],"doc":"Test extraction fails on corrupted JSON."}],"doc":"Test legacy data extraction (AC#2)."},{"name":"TestValidateMigrationIntegrity","line":126,"bases":[],"methods":[{"name":"test_validation_passes_with_matching_data","line":129,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation passes when all data preserved."},{"name":"test_validation_fails_on_missing_files","line":176,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation fails if files are missing."},{"name":"test_validation_fails_on_function_count_mismatch","line":201,"signature":"(self)","calls":[],"doc":"Test AC#4: Validation fails if function count doesn't match."}],"doc":"Test migration integrity validation (AC#4)."},{"name":"TestRollbackMigration","line":230,"bases":[],"methods":[{"name":"setUp","line":233,"signature":"(self)","calls":[],"doc":"Create temporary directory and test files."},{"name":"tearDown","line":248,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_rollback_restores_backup","line":252,"signature":"(self)","calls":[],"doc":"Test AC#5: Rollback restores original from backup."},{"name":"test_rollback_cleans_up_detail_directory","line":260,"signature":"(self)","calls":[],"doc":"Test AC#5: Rollback removes partial split artifacts."},{"name":"test_rollback_handles_missing_backup_gracefully","line":267,"signature":"(self)","calls":[],"doc":"Test rollback doesn't fail if backup missing."}],"doc":"Test rollback mechanism (AC#5)."},{"name":"TestMigrateToSplitFormat","line":275,"bases":[],"methods":[{"name":"setUp","line":278,"signature":"(self)","calls":[],"doc":"Create temporary directory with legacy index."},{"name":"tearDown","line":309,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_migrate_creates_split_format","line":314,"signature":"(self)","calls":[],"doc":"Test AC#1: Migration converts legacy \u2192 split format."},{"name":"test_migrate_creates_backup","line":331,"signature":"(self)","calls":[],"doc":"Test AC#3: Migration creates backup before converting."},{"name":"test_migrate_preserves_data","line":345,"signature":"(self)","calls":[],"doc":"Test AC#2: Migration preserves all data."},{"name":"test_migrate_validates_integrity","line":368,"signature":"(self)","calls":[],"doc":"Test AC#4: Migration validates data integrity."},{"name":"test_migrate_already_split_format","line":376,"signature":"(self)","calls":[],"doc":"Test migration detects already-split format and exits gracefully."},{"name":"test_migrate_nonexistent_index","line":387,"signature":"(self)","calls":[],"doc":"Test AC#5: Clear failure message when no index exists."},{"name":"test_migrate_performance_under_10_seconds","line":396,"signature":"(self)","calls":[],"doc":"Test NFR: Migration completes in <10 seconds."}],"doc":"Integration tests for full migration workflow (AC#1-5)."},{"name":"TestMigrationCommandLineInterface","line":405,"bases":[],"methods":[{"name":"setUp","line":408,"signature":"(self)","calls":[],"doc":"Create temporary directory with legacy index."},{"name":"tearDown","line":425,"signature":"(self)","calls":[],"doc":"Clean up temporary directory."},{"name":"test_migrate_flag_triggers_migration","line":431,"signature":"(self)","calls":[],"doc":"Test AC#1: --migrate flag triggers migration workflow."}],"doc":"Test --migrate flag integration (AC#1)."}],"imports":["json","os","shutil","tempfile","time","unittest","pathlib","unittest.mock","project_index","project_index","sys"]}},"call_graph_local":[["get_last_interactive_size","find_project_root"],["parse_index_flag","get_last_interactive_size"],["should_regenerate_index","calculate_files_hash"],["generate_index_at_size","calculate_files_hash"],["extract_python_signatures","extract_function_calls_python"],["extract_javascript_signatures","extract_function_calls_javascript"],["extract_shell_signatures","extract_function_calls_shell"],["load_gitignore_patterns","parse_gitignore"],["should_index_file","load_gitignore_patterns"],["should_index_file","matches_gitignore_pattern"],["load_detail_module","load_detail_module"],["find_module_for_file","find_module_for_file"],["load_detail_by_path","find_module_for_file"],["load_detail_by_path","load_detail_by_path"],["load_detail_by_path","load_detail_module"],["load_multiple_modules","load_detail_module"],["load_multiple_modules","load_multiple_modules"],["generate_split_index","create_module_references"],["generate_split_index","extract_git_metadata"],["generate_split_index","generate_detail_modules"],["generate_split_index","generate_tree_structure"],["generate_split_index","organize_into_modules"],["build_index","generate_tree_structure"],["extract_git_metadata","_fallback_to_mtime"],["migrate_to_split_format","create_backup"],["migrate_to_split_format","detect_index_format"],["migrate_to_split_format","extract_legacy_data"],["migrate_to_split_format","generate_split_index"],["migrate_to_split_format","rollback_migration"],["migrate_to_split_format","validate_migration_integrity"]],"doc_standard":{},"doc_archive":{}}